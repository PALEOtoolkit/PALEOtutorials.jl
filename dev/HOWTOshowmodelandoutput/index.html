<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Displaying model configuration and output from the Julia REPL · PALEOtutorials Documentation</title><meta name="title" content="Displaying model configuration and output from the Julia REPL · PALEOtutorials Documentation"/><meta property="og:title" content="Displaying model configuration and output from the Julia REPL · PALEOtutorials Documentation"/><meta property="twitter:title" content="Displaying model configuration and output from the Julia REPL · PALEOtutorials Documentation"/><meta name="description" content="Documentation for PALEOtutorials Documentation."/><meta property="og:description" content="Documentation for PALEOtutorials Documentation."/><meta property="twitter:description" content="Documentation for PALEOtutorials Documentation."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">PALEOtutorials Documentation</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">PALEOtutorials.jl documentation</a></li><li><span class="tocitem">Examples and Tutorials</span><ul><li><a class="tocitem" href="../ExampleInstallConfig/">Installation and getting started</a></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox"/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">reservoirs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../collated_examples/reservoirs/README/">Reservoirs and fluxes</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox"/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">solvers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../collated_examples/solvers/README/">ODE solvers</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-4" type="checkbox"/><label class="tocitem" for="menuitem-2-4"><span class="docs-label">error_examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../collated_examples/error_examples/README/">Configuration Errors</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-5" type="checkbox"/><label class="tocitem" for="menuitem-2-5"><span class="docs-label">CPU</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../collated_examples/CPU/README/">CPU (Carbon, Phosphorus, Uranium) model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-6" type="checkbox"/><label class="tocitem" for="menuitem-2-6"><span class="docs-label">CPU_modular</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../collated_examples/CPU_modular/README/">CPU (Carbon, Phosphorus, Uranium) model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-7" type="checkbox"/><label class="tocitem" for="menuitem-2-7"><span class="docs-label">ocean_chemistry</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../collated_examples/ocean_chemistry/README/">Ocean chemistry</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-8" type="checkbox"/><label class="tocitem" for="menuitem-2-8"><span class="docs-label">configurable_chemistry</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../collated_examples/configurable_chemistry/README/">Configurable chemistry using PALEOaqchem</a></li></ul></li></ul></li><li><span class="tocitem">Design</span><ul><li><a class="tocitem" href="../ComponentsWorkflow/">PALEOtoolkit components and workflow</a></li></ul></li><li><span class="tocitem">HOWTOS</span><ul><li class="is-active"><a class="tocitem" href>Displaying model configuration and output from the Julia REPL</a><ul class="internal"><li><a class="tocitem" href="#Displaying-large-tables-in-Julia"><span>Displaying large tables in Julia</span></a></li><li><a class="tocitem" href="#Find-code-and-documentation"><span>Find code and documentation</span></a></li><li><a class="tocitem" href="#Display-model-configuration"><span>Display model configuration</span></a></li><li><a class="tocitem" href="#Display-model-output"><span>Display model output</span></a></li><li><a class="tocitem" href="#Plot-model-output"><span>Plot model output</span></a></li><li><a class="tocitem" href="#Spatial-or-wavelength-dependent-output"><span>Spatial or wavelength-dependent output</span></a></li><li><a class="tocitem" href="#Save-and-load-output"><span>Save and load output</span></a></li><li><a class="tocitem" href="#Export-output-to-a-CSV-file"><span>Export output to a CSV file</span></a></li></ul></li><li><a class="tocitem" href="../HOWTOJuliaUsage/">Julia and VS code usage</a></li><li><a class="tocitem" href="../HOWTOadditionalconfig/">Optional additional configuration</a></li><li><a class="tocitem" href="../HOWTOminimalGit/">Minimal git workflow for scientific collaboration and reproducibility</a></li><li><a class="tocitem" href="../HOWTOdocumentation/">Creating and updating PALEO documentation</a></li></ul></li><li><a class="tocitem" href="../References/">References</a></li><li><a class="tocitem" href="../indexpage/">Index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">HOWTOS</a></li><li class="is-active"><a href>Displaying model configuration and output from the Julia REPL</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Displaying model configuration and output from the Julia REPL</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/PALEOtoolkit/PALEOtutorials.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/PALEOtoolkit/PALEOtutorials.jl/blob/main/docs/src/HOWTOshowmodelandoutput.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Displaying-model-configuration-and-output-from-the-Julia-REPL"><a class="docs-heading-anchor" href="#Displaying-model-configuration-and-output-from-the-Julia-REPL">Displaying model configuration and output from the Julia REPL</a><a id="Displaying-model-configuration-and-output-from-the-Julia-REPL-1"></a><a class="docs-heading-anchor-permalink" href="#Displaying-model-configuration-and-output-from-the-Julia-REPL" title="Permalink"></a></h1><p>The specific examples below were generated after running the <a href="https://github.com/PALEOtoolkit/PALEOcopse.jl"><code>PALEOcopse</code></a> <code>COPSE Reloaded</code> example from the Julia REPL, but apply to any PALEOtoolkit model.</p><h2 id="Displaying-large-tables-in-Julia"><a class="docs-heading-anchor" href="#Displaying-large-tables-in-Julia">Displaying large tables in Julia</a><a id="Displaying-large-tables-in-Julia-1"></a><a class="docs-heading-anchor-permalink" href="#Displaying-large-tables-in-Julia" title="Permalink"></a></h2><p>Several PALEO commands produce large tables.</p><p>There are several options to display these:</p><ul><li>Julia in VS code provides the <code>julia&gt; vscodedisplay(&lt;some table&gt;)</code> command. As of Jan 2022 this is now usually the best option.</li><li>Use <code>julia&gt; show(&lt;some table&gt;, allcols=true, allrows=true)</code> to show as text in the REPL. </li><li>Use <code>julia&gt; CSV.write(&quot;some_table.csv&quot;, &lt;some table&gt;)</code> to save as a CSV file and open in Excel etc.</li></ul><h2 id="Find-code-and-documentation"><a class="docs-heading-anchor" href="#Find-code-and-documentation">Find code and documentation</a><a id="Find-code-and-documentation-1"></a><a class="docs-heading-anchor-permalink" href="#Find-code-and-documentation" title="Permalink"></a></h2><p>The documentation for a PALEO reaction can be looked up using the  <code>PALEOboxes.doc_reaction</code> command:</p><pre><code class="nohighlight hljs">julia&gt; PB.doc_reaction(&quot;ReactionReservoirScalar&quot;)</code></pre><p>NB: the VS Code Documentation browser has similar functionality and is often easier to use. The key difference that it looks at definitions visible in the VS code projects and editor windows, whilst doc_reaction looks at definitions available to code in the current REPL ie provided by modules that are currently loaded in the REPL.</p><h2 id="Display-model-configuration"><a class="docs-heading-anchor" href="#Display-model-configuration">Display model configuration</a><a id="Display-model-configuration-1"></a><a class="docs-heading-anchor-permalink" href="#Display-model-configuration" title="Permalink"></a></h2><h3 id="Display-parameters:"><a class="docs-heading-anchor" href="#Display-parameters:">Display parameters:</a><a id="Display-parameters:-1"></a><a class="docs-heading-anchor-permalink" href="#Display-parameters:" title="Permalink"></a></h3><p>Examples illustrating the use of <a href="https://paleotoolkit.github.io/PALEOboxes.jl/stable/Solver%20API/#PALEOboxes.show_parameters"><code>PALEOboxes.show_parameters</code></a>:</p><p>To show parameters for every Reaction in the model:</p><pre><code class="nohighlight hljs">julia&gt; vscodedisplay(PB.show_parameters(model)) # show in VS code table viewer
julia&gt; show(PB.show_parameters(model), allrows=true) # show as text in REPL 
julia&gt; import CSV
julia&gt; CSV.write(&quot;parameters.csv&quot;, PB.show_parameters(model)) # save as CSV for Excel etc</code></pre><p>This illustrates the modularised model structure, with:</p><ul><li>Domains global, atm, land, ocean, oceansurface, oceanfloor, sedcrust containing forcings and biogeochemical Reactions, with Parameters attached to each Reaction.</li><li>Additional Domains fluxAtoLand, fluxLandtoSedCrust, fluxOceanBurial, fluxOceanfloor, fluxRtoOcean, fluxSedCrusttoAOcean containing flux coupler Reactions.</li></ul><p>To show parameters for a single Reaction:</p><pre><code class="nohighlight hljs">julia&gt; rct_temp_global = PB.get_reaction(model, &quot;global&quot;, &quot;temp_global&quot;)
julia&gt; PB.show_parameters(rct_temp_global)    # GEOCARB temperature function parameters</code></pre><p>The Julia Type of <code>rct_temp_global</code> <code>PALEOcopse.Global.Temperature.ReactionGlobalTemperatureBerner</code> usually makes it possible to guess the location <code>src/global/Temperature.jl</code> in the source code <a href="https://github.com/PALEOtoolkit/PALEOcopse.jl">https://github.com/PALEOtoolkit/PALEOcopse.jl</a> of the <code>PALEOcopse</code> Julia package.</p><h3 id="Display-Variables:"><a class="docs-heading-anchor" href="#Display-Variables:">Display Variables:</a><a id="Display-Variables:-1"></a><a class="docs-heading-anchor-permalink" href="#Display-Variables:" title="Permalink"></a></h3><h4 id="Show-Variables-in-the-model:"><a class="docs-heading-anchor" href="#Show-Variables-in-the-model:">Show Variables in the model:</a><a id="Show-Variables-in-the-model:-1"></a><a class="docs-heading-anchor-permalink" href="#Show-Variables-in-the-model:" title="Permalink"></a></h4><p>Use <a href="https://paleotoolkit.github.io/PALEOboxes.jl/stable/Solver%20API/#PALEOboxes.show_variables"><code>PALEOboxes.show_variables</code></a> to list all Variables in the model, or Variables for a specific Domain:</p><pre><code class="nohighlight hljs">julia&gt; vscodedisplay(PB.show_variables(model)) # VS code only
julia&gt; vscodedisplay(PB.show_variables(model, &quot;land&quot;)) # just the &quot;land&quot; Domain</code></pre><p>To list full information for all Variables in the model (including Variable linking and current values):</p><pre><code class="nohighlight hljs">julia&gt; vscodedisplay(PB.show_variables(model, modeldata=modeldata, showlinks=true))</code></pre><p>This illustrates the modularized model structure, with:</p><ul><li>Domains global, atm, land, ocean, oceansurface, oceanfloor, sedcrust containing Variables linked to Reactions (either property-dependencies or target-contributors pairs).</li><li>Additional Domains fluxAtoLand, fluxLandtoSedCrust, fluxOceanBurial, fluxOceanfloor, fluxRtoOcean, fluxSedCrusttoAOcean containing target-contributor pairs representing inter-module fluxes.</li></ul><h4 id="Show-linkage-for-a-single-Domain-or-ReactionMethod-Variable"><a class="docs-heading-anchor" href="#Show-linkage-for-a-single-Domain-or-ReactionMethod-Variable">Show linkage for a single Domain or ReactionMethod Variable</a><a id="Show-linkage-for-a-single-Domain-or-ReactionMethod-Variable-1"></a><a class="docs-heading-anchor-permalink" href="#Show-linkage-for-a-single-Domain-or-ReactionMethod-Variable" title="Permalink"></a></h4><p>To show linkage of a single Variable in Domain &quot;atm&quot; with name &quot;pO2PAL&quot;:</p><pre><code class="nohighlight hljs">julia&gt; PB.show_links(model, &quot;atm.pO2PAL&quot;)</code></pre><p>To show linkage of a ReactionMethod Variable with localname &quot;pO2PAL&quot;, Reaction &quot;ocean_copse&quot; in Domain &quot;ocean&quot;:</p><pre><code class="nohighlight hljs">julia&gt; PB.show_links(PB.get_reaction_variables(model, &quot;ocean&quot;, &quot;ocean_copse&quot;, &quot;pO2PAL&quot;))</code></pre><h2 id="Display-model-output"><a class="docs-heading-anchor" href="#Display-model-output">Display model output</a><a id="Display-model-output-1"></a><a class="docs-heading-anchor-permalink" href="#Display-model-output" title="Permalink"></a></h2><p>Model output is stored in a <a href="https://paleotoolkit.github.io/PALEOmodel.jl/stable/PALEOmodelOutput/#PALEOmodel.AbstractOutputWriter"><code>PALEOmodel.AbstractOutputWriter</code></a> object, which is available as <code>paleorun.output</code>, ie the <code>output</code> field of the default <a href="https://paleotoolkit.github.io/PALEOmodel.jl/stable/PALEOmodelOutput/#PALEOmodel.Run"><code>PALEOmodel.Run</code></a> instance created by the <code>COPSE_reloaded_reloaded.jl</code> script.</p><p>The default <a href="https://paleotoolkit.github.io/PALEOmodel.jl/stable/PALEOmodelOutput/#PALEOmodel.OutputWriters.OutputMemory"><code>PALEOmodel.OutputWriters.OutputMemory</code></a> stores model output in memory, by Domain:</p><pre><code class="nohighlight hljs">julia&gt; paleorun.output  # shows Domains</code></pre><p>To show metadata for all Variables in the output:</p><pre><code class="nohighlight hljs">julia&gt; vscodedisplay(PB.show_variables(paleorun.output)) # VS code only
julia&gt; vscodedisplay(PB.show_variables(paleorun.output, &quot;land&quot;)) # just the land Domain</code></pre><p>Output from a list of Variables or for each <code>Domain</code> can be exported to a Julia <a href="https://dataframes.juliadata.org/stable/">DataFrame</a>:</p><pre><code class="nohighlight hljs">julia&gt; # display data for a list of Variables as a Table
julia&gt; vscodedisplay(PB.get_table(paleorun.output, [&quot;atm.tmodel&quot;, &quot;atm.pCO2PAL&quot;, &quot;fluxOceanBurial.flux_total_P&quot;]))

julia&gt; # display data for every Variable in the &#39;atm&#39; Domain as a Table
julia&gt; vscodedisplay(PB.get_table(paleorun.output, &quot;atm&quot;))

julia&gt; # show a subset of output variables from the &#39;atm&#39; Domain
julia&gt; PB.get_table(paleorun.output, &quot;atm&quot;)[!, [:tmodel, :pCO2atm, :pCO2PAL]]</code></pre><p>Data from each Variable can be accessed as a <a href="https://paleotoolkit.github.io/PALEOmodel.jl/stable/PALEOmodelOutput/#PALEOmodel.FieldArray"><code>PALEOmodel.FieldArray</code></a> (a Python-xarray like struct with named dimensions and coordinates):</p><pre><code class="nohighlight hljs">julia&gt; pCO2atm = PALEOmodel.get_array(paleorun.output, &quot;atm.pCO2atm&quot;)
julia&gt; pCO2atm.values # raw data Array
julia&gt; pCO2atm.dims[1] # pCO2 is a scalar Variable with one dimension `records` which has a coordinate `tmodel`
julia&gt; pCO2atm.dims[1].coords[1].values # raw values for model time (`tmodel`)</code></pre><p>Raw data arrays can also be accessed as Julia Vectors using <code>get_data</code>:</p><pre><code class="nohighlight hljs">julia&gt; pCO2atm_raw = PB.get_data(paleorun.output, &quot;atm.pCO2atm&quot;)  # raw data Array
julia&gt; tmodel_raw = PB.get_data(paleorun.output, &quot;atm.tmodel&quot;) # raw data Array</code></pre><p>(here these are the values and coordinate of the <code>pCO2atm</code> <a href="https://paleotoolkit.github.io/PALEOmodel.jl/stable/PALEOmodelOutput/#PALEOmodel.FieldArray"><code>PALEOmodel.FieldArray</code></a>, ie <code>pCO2atm_raw == pCO2atm.values</code> and <code>tmodel_raw == pCO2atm.dims[1].coords[1].values</code>).</p><h2 id="Plot-model-output"><a class="docs-heading-anchor" href="#Plot-model-output">Plot model output</a><a id="Plot-model-output-1"></a><a class="docs-heading-anchor-permalink" href="#Plot-model-output" title="Permalink"></a></h2><p>The output can be plotted using the Julia Plots.jl package, see <a href="https://paleotoolkit.github.io/PALEOmodel.jl/stable/PALEOmodelOutput/#Plotting-output">Plotting output</a>. Plot recipes are defined for <a href="https://paleotoolkit.github.io/PALEOmodel.jl/stable/PALEOmodelOutput/#PALEOmodel.FieldArray"><code>PALEOmodel.FieldArray</code></a>, so output data can be plotted directly using the <code>plot</code> command:</p><pre><code class="nohighlight hljs">julia&gt; using Plots

julia&gt; plot(paleorun.output, &quot;atm.pCO2atm&quot;)  # plot output variable as a single command
julia&gt; plot(title=&quot;Oxygen&quot;, paleorun.output, [&quot;atm.pO2PAL&quot;, &quot;ocean.ANOX&quot;]) # overlay multiple output variables in one plot

julia&gt; pCO2atm = PALEOmodel.get_array(paleorun.output, &quot;atm.pCO2atm&quot;)
julia&gt; plot(pCO2atm) # a PALEOmodel.FieldArray can be plotted

julia&gt; pCO2atm_raw = PB.get_data(paleorun.output, &quot;atm.pCO2atm&quot;)  # raw data Array
julia&gt; tmodel_raw = PB.get_data(paleorun.output, &quot;atm.tmodel&quot;) # raw data Array
julia&gt; plot!(tmodel_raw, pCO2atm_raw, label=&quot;some raw data&quot;) # overlay data from standard Julia Vectors</code></pre><h2 id="Spatial-or-wavelength-dependent-output"><a class="docs-heading-anchor" href="#Spatial-or-wavelength-dependent-output">Spatial or wavelength-dependent output</a><a id="Spatial-or-wavelength-dependent-output-1"></a><a class="docs-heading-anchor-permalink" href="#Spatial-or-wavelength-dependent-output" title="Permalink"></a></h2><p>To analyze spatial or eg wavelength-dependent output (eg time series from a 1D column or 3D general circulation model, or quantities that are a function of wavelength or frequency), <code>PALEOmodel.get_array</code> takes an additional <code>selectargs::NamedTuple</code> argument to take 1D or 2D slices from the spatial, spectral and timeseries data. The <a href="https://paleotoolkit.github.io/PALEOmodel.jl/stable/PALEOmodelOutput/#PALEOmodel.FieldArray"><code>PALEOmodel.FieldArray</code></a> returned includes default coordinates to plot column (1D) and heatmap (2D) data, these can be overridden by supplying the optional <code>coords</code> keyword argument.</p><h3 id="Examples-for-a-column-based-model"><a class="docs-heading-anchor" href="#Examples-for-a-column-based-model">Examples for a column-based model</a><a id="Examples-for-a-column-based-model-1"></a><a class="docs-heading-anchor-permalink" href="#Examples-for-a-column-based-model" title="Permalink"></a></h3><p>Visualisation of spatial and wavelength-dependent output from the PALEOdev.jl ozone photochemistry example (a single 1D atmospheric column):</p><h4 id="1D-column-data"><a class="docs-heading-anchor" href="#1D-column-data">1D column data</a><a id="1D-column-data-1"></a><a class="docs-heading-anchor-permalink" href="#1D-column-data" title="Permalink"></a></h4><pre><code class="nohighlight hljs">julia&gt; plot(title=&quot;O3 mixing ratio&quot;, output, &quot;atm.O3_mr&quot;, (tmodel=[0.0, 0.1, 1.0, 10.0, 100.0, 1000.0], column=1),
            swap_xy=true, xscale=:log10, labelattribute=:filter_records) # plots O3 vs default height coordinate</code></pre><p>Here the optional <code>labelattribute=:filter_records</code> keyword argument is used to generate plot labels from the <code>:filter_records</code> FieldArray attribute, which contains the <code>tmodel</code> values used to select the timeseries records.  The plot recipe expands the Vector-valued <code>tmodel</code> argument to overlay a sequence of plots.</p><p>This is equivalent to first creating and then plotting a sequence of <code>FieldArray</code> objects:</p><pre><code class="nohighlight hljs">julia&gt; O3_mr = PALEOmodel.get_array(paleorun.output, &quot;atm.O3_mr&quot;, (tmodel=0.0, column=1))
julia&gt; plot(title=&quot;O3 mixing ratio&quot;, O3_mr, swap_xy=true, xscale=:log10, labelattribute=:filter_records)
julia&gt; O3_mr = PALEOmodel.get_array(paleorun.output, &quot;atm.O3_mr&quot;, (tmodel=0.1, column=1))
julia&gt; plot!(O3_mr, swap_xy=true, labelattribute=:filter_records)</code></pre><p>The default height coordinate from the model grid can be replaced using the optional <code>coords</code> keyword argument, eg</p><pre><code class="nohighlight hljs">julia&gt; plot(title=&quot;O3 mixing ratio&quot;, output, &quot;atm.O3_mr&quot;, (tmodel=[0.0, 0.1, 1.0, 10.0, 100.0, 1000.0], column=1),
            coords=[&quot;p&quot;=&gt;(&quot;atm.pmid&quot;, &quot;atm.plower&quot;, &quot;atm.pupper&quot;)],
            swap_xy=true, xscale=:log10, yflip=true, yscale=:log10, labelattribute=:filter_records) # plots O3 vs pressure</code></pre><p>The current values in the <code>modeldata</code> struct can also be plotted using the same syntax, eg</p><pre><code class="nohighlight hljs">julia&gt; plot(title=&quot;O2, O3 mixing ratios&quot;, modeldata, [&quot;atm.O2_mr&quot;, &quot;atm.O3_mr&quot;], (column=1,),
            swap_xy=true, xscale=:log10) # plot current value of O2, O3 vs height</code></pre><h4 id="Wavelength-dependent-data"><a class="docs-heading-anchor" href="#Wavelength-dependent-data">Wavelength-dependent data</a><a id="Wavelength-dependent-data-1"></a><a class="docs-heading-anchor-permalink" href="#Wavelength-dependent-data" title="Permalink"></a></h4><pre><code class="nohighlight hljs">julia&gt; plot(title=&quot;direct transmittance&quot;, output, [&quot;atm.direct_trans&quot;], (tmodel=1e12, column=1, cell=[1, 80]),
            ylabel=&quot;fraction&quot;, labelattribute=:filter_region) # plots vs wavelength</code></pre><p>Here <code>tmodel=1e12</code> selects the last model time output, and <code>column=1, cell=[1, 80]</code> selects the top and bottom cells within the first (only) 1D column. The <code>labelattribute=:filter_region</code> keyword argument is used to generate plot labels from the <code>:filter_region</code> FieldArray attribute, which contains the <code>column</code> and <code>cell</code> values used to select the spatial region.</p><h3 id="Examples-for-a-3D-GCM-based-model"><a class="docs-heading-anchor" href="#Examples-for-a-3D-GCM-based-model">Examples for a 3D GCM-based model</a><a id="Examples-for-a-3D-GCM-based-model-1"></a><a class="docs-heading-anchor-permalink" href="#Examples-for-a-3D-GCM-based-model" title="Permalink"></a></h3><p>Visualisation of spatial output from the 3D GENIE transport-matrix example (PALEOdev.jl repository)</p><h3 id="Horizontal-slices-across-levels"><a class="docs-heading-anchor" href="#Horizontal-slices-across-levels">Horizontal slices across levels</a><a id="Horizontal-slices-across-levels-1"></a><a class="docs-heading-anchor-permalink" href="#Horizontal-slices-across-levels" title="Permalink"></a></h3><pre><code class="nohighlight hljs">julia&gt; heatmap(paleorun.output, &quot;ocean.O2_conc&quot;, (tmodel=1e12, k=1), swap_xy=true)</code></pre><p>Here <code>k=1</code> selects a horizontal level corresponding to model grid cells with index k=1, which is the ocean surface in the GENIE grid.</p><h3 id="Vertical-section-at-constant-longitude"><a class="docs-heading-anchor" href="#Vertical-section-at-constant-longitude">Vertical section at constant longitude</a><a id="Vertical-section-at-constant-longitude-1"></a><a class="docs-heading-anchor-permalink" href="#Vertical-section-at-constant-longitude" title="Permalink"></a></h3><pre><code class="nohighlight hljs">julia&gt; heatmap(paleorun.output, &quot;ocean.O2_conc&quot;, (tmodel=1e12, i=10), swap_xy=true, mult_y_coord=-1.0)</code></pre><p>Here <code>i=10</code> selects a section at longitude corresponding to model grid cells with index i=10.</p><h2 id="Save-and-load-output"><a class="docs-heading-anchor" href="#Save-and-load-output">Save and load output</a><a id="Save-and-load-output-1"></a><a class="docs-heading-anchor-permalink" href="#Save-and-load-output" title="Permalink"></a></h2><p>Model output can be saved and loaded using the <a href="https://paleotoolkit.github.io/PALEOmodel.jl/stable/PALEOmodelOutput/#PALEOmodel.OutputWriters.save_netcdf"><code>PALEOmodel.OutputWriters.save_netcdf</code></a> and <a href="https://paleotoolkit.github.io/PALEOmodel.jl/stable/PALEOmodelOutput/#PALEOmodel.OutputWriters.load_netcdf%21"><code>PALEOmodel.OutputWriters.load_netcdf!</code></a> methods.</p><p>NB: the <a href="https://paleotoolkit.github.io/PALEOmodel.jl/stable/PALEOmodelOutput/#PALEOmodel.OutputWriters.save_jld2"><code>PALEOmodel.OutputWriters.save_jld2</code></a> and <a href="https://paleotoolkit.github.io/PALEOmodel.jl/stable/PALEOmodelOutput/#PALEOmodel.OutputWriters.load_jld2%21"><code>PALEOmodel.OutputWriters.load_jld2!</code></a> methods are still available, but no longer recommended as these files will not remain readable with future Julia or PALEO versions.</p><h2 id="Export-output-to-a-CSV-file"><a class="docs-heading-anchor" href="#Export-output-to-a-CSV-file">Export output to a CSV file</a><a id="Export-output-to-a-CSV-file-1"></a><a class="docs-heading-anchor-permalink" href="#Export-output-to-a-CSV-file" title="Permalink"></a></h2><p>To write Model output from a single Domain to a CSV file:</p><pre><code class="nohighlight hljs">julia&gt; import CSV
julia&gt; CSV.write(&quot;copse_land.csv&quot;, PB.get_table(paleorun.output, &quot;land&quot;)) # all Variables from land Domain
julia&gt; CSV.write(&quot;copse_atm.csv&quot;, PB.get_table(paleorun.output, &quot;atm&quot;)[!, [:tmodel, :pCO2atm, :pO2atm]]) # subset of Variables from atm Domain</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../ComponentsWorkflow/">« PALEOtoolkit components and workflow</a><a class="docs-footer-nextpage" href="../HOWTOJuliaUsage/">Julia and VS code usage »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Wednesday 26 June 2024 11:10">Wednesday 26 June 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
